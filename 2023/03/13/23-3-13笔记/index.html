
<!DOCTYPE html>
<html lang="zh-Hans">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
        <title>SSM框架：MyBatis | Yuan来是你</title>
        <meta name="author" content="Yuan">
        <meta name="description" content="从前车马很慢，书信很远，一生只够爱一个人！">
        <meta name="keywords" content="blog,technology,life,博客,技术,生活,算法">
        <link rel="icon" href="https://pic.imgdb.cn/item/63eb93ecf144a0100702ac89.jpg">
        <script src="https://cdn.staticfile.org/instant.page/5.1.0/instantpage.min.js" type="module"></script>
        <script src="https://cdn.staticfile.org/font-awesome/6.2.0/js/all.min.js"></script>
        
        <link rel="stylesheet" href="/css/fonts.min.css">
        <link rel="stylesheet" href="/css/particlex.css">
        
        <script src="https://cdn.staticfile.org/vue/3.2.33/vue.global.prod.min.js"></script>
        <script src="https://cdn.staticfile.org/animejs/3.2.1/anime.min.js"></script>
    <meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <div id="loading" style="height:100vh;width:100vw;position:fixed;display:flex;z-index:200;justify-content:space-between;background:#fff;transition:opacity 0.3s ease-out"><div style="position:fixed;height:100vh;width:100vw;display:flex;justify-content:center;align-items:center"><div id="loadcontent" style="width:50vmin;height:50vmin;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px #a3ddfb;text-align:center"><div><h2>LOADING...</h2><p style="word-break:keep-all">加载过慢请开启缓存(浏览器默认开启)</p><div><img alt="loading" src="/loading.gif"></div></div></div></div></div>
        <div id="layout">
            <i data-fa-symbol="calendar-solid" class="fa-solid fa-calendar fa-fw"></i>
            <i data-fa-symbol="bookmark-solid" class="fa-solid fa-bookmark fa-fw"></i>
            <i data-fa-symbol="tags-solid" class="fa-solid fa-tags fa-fw"></i>
            <transition name="into">
                <div v-show="show_page" style="display: -not-none">
                    <div id="menu_show">
                         
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">Yuan来是你</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;about</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;tags</span>
        </a>
        
    </div>
    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div class="curtain" @click="menu_show = !menu_show" v-show="menu_show"></div>
        <div :class="'title'" @click="menu_show = !menu_show">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;Yuan来是你</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">home</div>
                </div>
            </a>
            
            <a href="/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">about</div>
                </div>
            </a>
            
            <a href="/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">archives</div>
                </div>
            </a>
            
            <a href="/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">categories</div>
                </div>
            </a>
            
            <a href="/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">tags</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>
                    </div>
                    <div id="main">
                        
<div class="article">
    <div>
        <h1>SSM框架：MyBatis </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#calendar-solid"></use></svg>
            </span>
            2023/3/13
        </span>
        
        <span class="category">
            <a href="/categories/学习/">
                <span class="icon">
                    <svg class="fa-icon"><use xlink:href="#bookmark-solid"></use></svg>
                </span>
                学习
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#tags-solid"></use></svg>
            </span>
            
            <span class="tag">
                
                <a href="/tags/Java/" style="color: #03a9f4">
                    Java
                </a>
            </span>
            
        </span>
        
    </div>
    <div class="content" v-pre>
        <h2 id="pom-xml引入的依赖："><a href="#pom-xml引入的依赖：" class="headerlink" title="pom.xml引入的依赖："></a>pom.xml引入的依赖：</h2><h4 id="tomcat："><a href="#tomcat：" class="headerlink" title="tomcat："></a>tomcat：</h4><pre><code class="xml">&lt;!-- https://mvnrepository.com/artifact/org.apache.tomcat/tomcat-servlet-api --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.tomcat&lt;/groupId&gt;
    &lt;artifactId&gt;tomcat-servlet-api&lt;/artifactId&gt;
    &lt;version&gt;9.0.73&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- https://mvnrepository.com/artifact/org.apache.tomcat/tomcat-jsp-api --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.tomcat&lt;/groupId&gt;
    &lt;artifactId&gt;tomcat-jsp-api&lt;/artifactId&gt;
    &lt;version&gt;9.0.73&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="引入jstl表达式（标签库）"><a href="#引入jstl表达式（标签库）" class="headerlink" title="引入jstl表达式（标签库）"></a>引入jstl表达式（标签库）</h4><pre><code class="xml">&lt;!-- jstl表达式 --&gt;
&lt;!-- https://mvnrepository.com/artifact/org.apache.taglibs/taglibs-standard-spec --&gt;
&lt;dependency&gt;
        &lt;groupId&gt;org.apache.taglibs&lt;/groupId&gt;
        &lt;artifactId&gt;taglibs-standard-spec&lt;/artifactId&gt;
        &lt;version&gt;1.2.5&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- https://mvnrepository.com/artifact/org.apache.taglibs/taglibs-standard-impl --&gt;
&lt;dependency&gt;
        &lt;groupId&gt;org.apache.taglibs&lt;/groupId&gt;
        &lt;artifactId&gt;taglibs-standard-impl&lt;/artifactId&gt;
        &lt;version&gt;1.2.5&lt;/version&gt;
        &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="Spring-MVC："><a href="#Spring-MVC：" class="headerlink" title="Spring MVC："></a>Spring MVC：</h4><pre><code class="xml">在properties中定义：
&lt;spring.version&gt;5.3.25&lt;/spring.version&gt;

&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
    &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="配置SpringMVC-xml，Spring-xml"><a href="#配置SpringMVC-xml，Spring-xml" class="headerlink" title="配置SpringMVC.xml，Spring.xml"></a>配置SpringMVC.xml，Spring.xml</h4><p>SpringMVC只扫描controller即可</p>
<p>Spring只扫描service.impl即可</p>
<h4 id="引入dbcp2数据库连接池的依赖："><a href="#引入dbcp2数据库连接池的依赖：" class="headerlink" title="引入dbcp2数据库连接池的依赖："></a>引入dbcp2数据库连接池的依赖：</h4><pre><code class="xml">&lt;!-- https://mvnrepository.com/artifact/org.apache.commons/commons-dbcp2 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
    &lt;artifactId&gt;commons-dbcp2&lt;/artifactId&gt;
    &lt;version&gt;2.9.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="引入mysql连接驱动的依赖"><a href="#引入mysql连接驱动的依赖" class="headerlink" title="引入mysql连接驱动的依赖"></a>引入mysql连接驱动的依赖</h4><pre><code class="xml">&lt;!-- https://mvnrepository.com/artifact/com.mysql/mysql-connector-j --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.mysql&lt;/groupId&gt;
    &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;
    &lt;version&gt;8.0.32&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="引入mybatis的依赖"><a href="#引入mybatis的依赖" class="headerlink" title="引入mybatis的依赖"></a>引入mybatis的依赖</h4><pre><code class="xml">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
    &lt;version&gt;3.5.13&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- 用于spring整合mybatis --&gt;
&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis-spring --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
    &lt;version&gt;3.0.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="创建mapper文件夹"><a href="#创建mapper文件夹" class="headerlink" title="创建mapper文件夹"></a>创建mapper文件夹</h4><h4 id="引入SpringJDBC的依赖"><a href="#引入SpringJDBC的依赖" class="headerlink" title="引入SpringJDBC的依赖"></a>引入SpringJDBC的依赖</h4><pre><code class="xml">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-jdbc --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
    &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="引入lombok依赖：自动生成setter-x2F-getter方法，使用需要加-Data注解"><a href="#引入lombok依赖：自动生成setter-x2F-getter方法，使用需要加-Data注解" class="headerlink" title="引入lombok依赖：自动生成setter&#x2F;getter方法，使用需要加@Data注解"></a>引入lombok依赖：自动生成setter&#x2F;getter方法，使用需要加@Data注解</h4><pre><code class="xml">&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;
&lt;!-- 仅编译时需要 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
    &lt;artifactId&gt;lombok&lt;/artifactId&gt;
    &lt;version&gt;1.18.26&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="配置映射器，XXXDao-xml"><a href="#配置映射器，XXXDao-xml" class="headerlink" title="配置映射器，XXXDao.xml"></a>配置映射器，XXXDao.xml</h4><h4 id="配置mybatis-xml"><a href="#配置mybatis-xml" class="headerlink" title="配置mybatis.xml"></a>配置mybatis.xml</h4><pre><code class="xm">&lt;!-- 对模型包配置别名，之后就可以不用写全称了 --&gt;
&lt;typeAliases&gt;
    &lt;package name=&quot;com.yuan.model&quot;/&gt;
&lt;/typeAliases&gt;
</code></pre>
<h4 id="引入fileupload，文件上传"><a href="#引入fileupload，文件上传" class="headerlink" title="引入fileupload，文件上传"></a>引入fileupload，文件上传</h4><pre><code class="xml">&lt;!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;commons-fileupload&lt;/groupId&gt;
    &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;
    &lt;version&gt;1.5&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="引入二级缓存的库"><a href="#引入二级缓存的库" class="headerlink" title="引入二级缓存的库"></a>引入二级缓存的库</h4><pre><code class="xml">&lt;!--二级缓存的库--&gt;
&lt;!-- https://mvnrepository.com/artifact/org.mybatis.caches/mybatis-caffeine --&gt;
&lt;dependency&gt;
        &lt;groupId&gt;org.mybatis.caches&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis-caffeine&lt;/artifactId&gt;
        &lt;version&gt;1.1.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="引入日志库"><a href="#引入日志库" class="headerlink" title="引入日志库"></a>引入日志库</h4><pre><code class="xml">&lt;!--引入日志库--&gt;
&lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-api --&gt;
&lt;dependency&gt;
        &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
        &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
        &lt;version&gt;2.0.6&lt;/version&gt;
&lt;/dependency&gt;
&lt;!--引入日志实现--&gt;
&lt;!-- https://mvnrepository.com/artifact/ch.qos.logback/logback-classic --&gt;
&lt;dependency&gt;
        &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
        &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
        &lt;version&gt;1.4.5&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- https://mvnrepository.com/artifact/ch.qos.logback/logback-core --&gt;
&lt;dependency&gt;
        &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
        &lt;artifactId&gt;logback-core&lt;/artifactId&gt;
        &lt;version&gt;1.4.5&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<hr>
<h4 id="pom-xml，配置依赖"><a href="#pom-xml，配置依赖" class="headerlink" title="pom.xml，配置依赖"></a>pom.xml，配置依赖</h4><pre><code class="xml">&lt;scope&gt;runtime&lt;/scope&gt;
&lt;scope&gt;complie&lt;/scope&gt;
&lt;scope&gt;provided&lt;/scope&gt;
</code></pre>
<p>complie：编译时需要，运行时需要</p>
<p>runtime：仅运行时需要</p>
<p>provided：编译时需要，运行时不需要，由外部提供。比如tomcat-servlet-api，在tomcat文件夹下就有</p>
<p>test：仅在测试时需要</p>
<h4 id="lombok框架：自动创建setter-x2F-getter方法"><a href="#lombok框架：自动创建setter-x2F-getter方法" class="headerlink" title="lombok框架：自动创建setter&#x2F;getter方法"></a>lombok框架：自动创建setter&#x2F;getter方法</h4><p>引入依赖</p>
<pre><code class="xml">&lt;!-- 仅编译时使用 --&gt;
&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
    &lt;artifactId&gt;lombok&lt;/artifactId&gt;
    &lt;version&gt;1.18.26&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
<p>加注解</p>
<p><strong>@Data</strong></p>
<p>自动创建setter&#x2F;getter&#x2F;toString方法</p>
<p>缺陷：在setter&#x2F;getter方法中无法自定义的一些内容，打断点Debug也不方便</p>
<h3 id="mybatis的接口参数（定义在Dao接口中的方法参数列表）："><a href="#mybatis的接口参数（定义在Dao接口中的方法参数列表）：" class="headerlink" title="mybatis的接口参数（定义在Dao接口中的方法参数列表）："></a>mybatis的接口参数（定义在Dao接口中的方法参数列表）：</h3><p>1、支持基本数据类型的封装类型。Integer，String，……，LocalDate，LocalTime，BigInteger，BigDecimal</p>
<p>2、支持POJO（javabean），模型类。Student、Employee……</p>
<p>3、支持Map。</p>
<p>4、注意：以上为默认支持，但参数只能是一个。</p>
<p>5、当只有一个参数，且是基本数据类型的时候，mapper.xml中用啥都一样</p>
<p>6、当只有一个参数的时候，可以配置属性parameterType，表示由dao接口传到mapper的参数的类型（可以省略）</p>
<p>7、除了上述情况之外的，必须使用@Param注解</p>
<ul>
<li>1.数组作为参数</li>
<li>2.List作为参数</li>
<li>3.Set作为参数</li>
<li>4.以上多种数据类型的组合，超过两个参数</li>
</ul>
<h3 id="mybatis的映射类型："><a href="#mybatis的映射类型：" class="headerlink" title="mybatis的映射类型："></a>mybatis的映射类型：</h3><p>1、resultType：结果集类型，要和查询结果的类型一致</p>
<p>2、resultMap：结果集映射，配置自定义映射</p>
<h4 id="参数的JbdcType和javaType（比如Map中的键值获得的参数的类型，mybatis可能推断不出）"><a href="#参数的JbdcType和javaType（比如Map中的键值获得的参数的类型，mybatis可能推断不出）" class="headerlink" title="参数的JbdcType和javaType（比如Map中的键值获得的参数的类型，mybatis可能推断不出）"></a>参数的JbdcType和javaType（比如Map中的键值获得的参数的类型，mybatis可能推断不出）</h4><pre><code class="xml">#&#123;pageNo, jdbcType=INTEGER&#125;
#&#123;pageNo, javaType=Integer&#125;
</code></pre>
<pre><code class="text">#和$的区别
$字符串直接拼接，缺点：可能会引发sql注入
#只能用在where条件中，编译完变成？

$原理是字符串拼接
#原理是？
</code></pre>
<p>能用井号就用井号</p>
<p>模糊查询的解决方案：</p>
<p>1、’%${……}%’</p>
<p>2、将查询属性手动添加%，改变了属性值</p>
<p>3、使用bind标记定义一个变量</p>
<pre><code class="xml">&lt;bind name = &quot;namelike&quot; value = &quot;&#39;%&#39;+bbs.name+&#39;%&#39;&quot; /&gt;
and name like #&#123;namelike&#125;
</code></pre>
<h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3><p>1、引入日志相关库，slf4j</p>
<p>2、引入日志实现，logback-classic、logback-core</p>
<h2 id="关联查询"><a href="#关联查询" class="headerlink" title="关联查询"></a>关联查询</h2><h4 id="1、一对一关联查询：association"><a href="#1、一对一关联查询：association" class="headerlink" title="1、一对一关联查询：association"></a>1、一对一关联查询：association</h4><h5 id="StudentDao-xml"><a href="#StudentDao-xml" class="headerlink" title="StudentDao.xml"></a>StudentDao.xml</h5><pre><code class="xml">&lt;resultMap id=&quot;StudentMap&quot; type=&quot;Student&quot;&gt;
    &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;
    &lt;result column=&quot;name&quot; property=&quot;name&quot;/&gt;
    &lt;result column=&quot;pinyin&quot; property=&quot;py&quot;/&gt;
    &lt;result column=&quot;sex&quot; property=&quot;sex&quot; /&gt;
    &lt;result column=&quot;birthday&quot; property=&quot;birthday&quot; /&gt;
    &lt;result column=&quot;phone&quot; property=&quot;phone&quot;/&gt;

    
    &lt;!--创建一个一对一关联查询--&gt;
    &lt;!--property=&quot;classEntity&quot;：查出来的数据类型是classEntity--&gt;
    &lt;!--column=&quot;class_id&quot;：用class_id这个外键去查找-&gt;

    &lt;association property=&quot;classEntity&quot;
                     column=&quot;class_id&quot; select=&quot;com.situ.demo1.dao.ClassEntityDAO.findById&quot;/&gt;
&lt;/resultMap&gt;


&lt;select id=&quot;findAll&quot; resultMap=&quot;StudentMap&quot;&gt;
    select id,
        `name`,
        pinyin,
        sex,
        birthday,
        phone,
        class_id
    from t_student
    limit #&#123;pageNo&#125;, #&#123;pageSize&#125;
&lt;/select&gt;


&lt;select id=&quot;findById&quot; resultMap=&quot;ClassEntityMap&quot; useCache=&quot;true&quot;&gt;
    select id, `class_name` as `name`, begin_time
    from t_class
    where id = #&#123;id&#125;
&lt;/select&gt;
</code></pre>
<h5 id="StudentController"><a href="#StudentController" class="headerlink" title="StudentController"></a>StudentController</h5><pre><code class="java">List&lt;Student&gt; studentList = service.findAll(pageNo, pageSize);

map.put(&quot;students&quot;, studentList);
return &quot;student/list&quot;;
</code></pre>
<h5 id="list-jsp"><a href="#list-jsp" class="headerlink" title="list.jsp"></a>list.jsp</h5><pre><code class="jsp">&lt;c:forEach items=&quot;$&#123;students&#125;&quot; var=&quot;stu&quot;&gt;
    &lt;tr&gt;
        &lt;td&gt;$&#123;stu.id&#125;&lt;/td&gt;
        &lt;td&gt;$&#123;stu.name&#125;&lt;/td&gt;
        &lt;td&gt;$&#123;stu.py&#125;&lt;/td&gt;
        &lt;td&gt;$&#123;stu.sex&#125;&lt;/td&gt;
        &lt;td&gt;$&#123;stu.phone&#125;&lt;/td&gt;
        &lt;td&gt;$&#123;stu.classEntity.name&#125;&lt;/td&gt;
    &lt;/tr&gt;
&lt;/c:forEach&gt;
</code></pre>
<h4 id="2、一对多：collection"><a href="#2、一对多：collection" class="headerlink" title="2、一对多：collection"></a>2、一对多：collection</h4><pre><code class="xml">&lt;resultMap id=&quot;ClassEntityMap&quot; type=&quot;ClassEntity&quot;&gt;
    &lt;id column=&quot;id&quot; property=&quot;id&quot; /&gt;
    &lt;result column=&quot;class_name&quot; property=&quot;name&quot; /&gt;
    &lt;result column=&quot;begin_time&quot; property=&quot;beginTime&quot; /&gt;

    &lt;!--配置一对多查询--&gt;
    &lt;collection property=&quot;students&quot; column=&quot;id&quot;
        select=&quot;com.situ.demo1.dao.StudentDAO.findByClassId&quot; /&gt;
&lt;/resultMap&gt;


&lt;select id=&quot;findByClassId&quot; resultMap=&quot;StudentMap&quot;&gt;
    select id,
           `name`,
           pinyin,
           sex,
           birthday,
           phone,
           class_id
    from t_student where class_id = #&#123;id&#125;
&lt;/select&gt;
</code></pre>
<h3 id="N-1问题"><a href="#N-1问题" class="headerlink" title="N+1问题"></a>N+1问题</h3><p>解决方案：<strong>（开关在mybatis.xml中）</strong></p>
<ul>
<li><p>延迟加载：打开开关，当用到关联数据时，才发出查询，在某种程度上，会解决N+1的问题。开启延迟加载之后，所有的关联查询都会视需要而加载</p>
<pre><code class="xml">&lt;!-- 是否开启延迟加载，懒加载。默认未启用 --&gt;
&lt;setting name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot;/&gt;
</code></pre>
</li>
<li><p>二级缓存：</p>
<ul>
<li><p>打开开关</p>
<pre><code class="xml">&lt;!-- 启用二级缓存，总开关 --&gt;
&lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;
</code></pre>
</li>
<li><p>引入二级缓存的库</p>
<pre><code class="xml">&lt;!--二级缓存的库--&gt;
&lt;!-- https://mvnrepository.com/artifact/org.mybatis.caches/mybatis-caffeine --&gt;
&lt;dependency&gt;
        &lt;groupId&gt;org.mybatis.caches&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis-caffeine&lt;/artifactId&gt;
        &lt;version&gt;1.1.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li><p>在要缓存的映射器mapper写入配置</p>
<pre><code class="xml">&lt;cache flushInterval=&quot;30000&quot; type=&quot;org.mybatis.caches.caffeine.CaffeineCache&quot;/&gt;
</code></pre>
</li>
<li><p>在XXXdao.xml中，要查询的语句，加入useCache&#x3D;”true”</p>
<pre><code class="xml">&lt;select id=&quot;findById&quot; resultMap=&quot;ClassEntityMap&quot; useCache=&quot;true&quot;&gt;
    select id, `class_name` as `name`, begin_time
    from t_class
    where id = #&#123;id&#125;
&lt;/select&gt;
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="一级缓存和二级缓存"><a href="#一级缓存和二级缓存" class="headerlink" title="一级缓存和二级缓存"></a>一级缓存和二级缓存</h3><p>1、一级缓存：在同一个会话之内进行缓存。SqlSession级别，使用的场景比较少。（发出多次相同的查询，进行了缓存）</p>
<p>在业务类里进行创建SqlSession，会话，需要手动开启会话</p>
<pre><code class="java">private SqlSessionFactory sf;

@Autowired
public void setSf(SqlSessionFactory sf) &#123;
    this.sf = sf;
&#125;

SqlSession session = sf.openSession();//创建了一个会话
Map&lt;String, Object&gt; map = Map.of(&quot;pageNo&quot;, pageNo, &quot;pageSize&quot;, pageSize);
List&lt;Student&gt; students = session.selectList(&quot;com.situ.demo1.dao.StudentDAO.findAll&quot;, map);

session.close();

return students;
</code></pre>
<p>2、二级缓存：在整个查询期间，都可以一直生效，不是在SqlSession级别</p>

    </div>
    
    
</div>
                         
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 2022 - 2023 Yuan来是你
            <span class="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            @Yuan
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a> & <a
                target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a></div>
        
    </div>
</footer>
                    </div>
                </div>
            </transition>
            <div id="img_show">
                <img id="img_content" alt="img_show">
            </div>
        </div>
        <script src="https://cdn.staticfile.org/highlight.js/11.5.1/highlight.min.js"></script>
        <script src="/js/particlex.js"></script>
        <script src="/js/showimg.js"></script>
        

        <canvas id="fireworks" style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:2147483647"></canvas>
        <script src="/js/fireworks.js"></script>

    </body>
</html>
